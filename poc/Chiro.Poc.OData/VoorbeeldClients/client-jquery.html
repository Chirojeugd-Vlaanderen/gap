<!DOCTYPE html>
<!-- DISCLAIMER: ik heb weinig kaas gegeten van JQuery, ik doe altijd
     maar wat :-) -->
<html>
	<head>
		<title>API-test</title>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

		<script type="text/javascript">
			// pas onderstaande aan
			var SERVICE_URL='http://lap-jve2.chiro.lokaal/ODataPoc/DataService.svc';

			// In de implementatie van DataServicesJSONP heet de callback-parameter
			// '$callback' (en niet gewoon 'callback')

			$.ajaxSetup({jsonp: '$callback'});
		</script>

	</head>

	<body>

		<button id="knop">Klik me</button> <br />
		<div id="ledenlijst" />

		<script type="text/javascript">
			$("#knop").click(function() {

				// Blijkbaar is het onmogelijk om request headers aan
				// te passen als je JSONP gebruikt

				var myurl=SERVICE_URL+"/Leden?$format=json";

				$.ajax({
					dataType: 'jsonp',
  					url: myurl,
					username: 'apitest',
					password: 'PubliekGeheim.',
					success: function (data) {
						$("#ledenlijst").text('');
						$.each(
							data.d.results, 
							function(index, value){
								$("#ledenlijst").append(value.Naam + " van de " + value.Afdeling + " <br />" );
							});
  					},
				});
			});
		</script>

	</body>
</html>
		
